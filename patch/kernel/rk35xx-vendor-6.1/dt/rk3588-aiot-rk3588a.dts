// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright (c) 2021 Rockchip Electronics Co., Ltd.
 *
 */

/dts-v1/;

#include "rk3588-evb7-lp4.dtsi"
#include "rk3588-evb7-imx415.dtsi"
#include "rk3588-linux.dtsi"

/ {
	model = "Shimeta Aiot rk3588a";
	compatible = "rockchip,rk3588-aiot-rk3588a", "rockchip,rk3588";

	chosen {
		bootargs = "earlycon=uart8250,mmio32,0xfeb50000 console=ttyFIQ0 irqchip.gicv3_pseudo_nmi=0";
	};

	leds {
		compatible = "gpio-leds";
		work {
			gpios = <&gpio4 RK_PB7 GPIO_ACTIVE_HIGH>;
			linux,default-trigger = "heartbeat";
		};
	};


	mcuinf {
		compatible = "smdtmcu,STM8S00K3";
		status = "okay";
		reg = <0x62>;
		#pwm-cells = <2>;
		/* MCU interrupt pin: GPIO0_B0 */
		int-gpio = <&gpio0 RK_PB0 GPIO_ACTIVE_HIGH>;
	};

	adc-keys {
		compatible = "adc-keys";
		io-channels = <0x1d5 0x01>;
		io-channel-names = "buttons";
		keyup-threshold-microvolt = <0x1b7740>;
		poll-interval = <0x64>;
		status = "okay";

		vol-up-key {
			label = "volume up";
			linux,code = <0x73>;
			press-threshold-microvolt = <0x4268>;
		};

		vol-down-key {
			label = "volume down";
			linux,code = <0x72>;
			press-threshold-microvolt = <0x65ce8>;
		};

		menu-key {
			label = "menu";
			linux,code = <0x8b>;
			press-threshold-microvolt = <0xd9490>;
		};

		back-key {
			label = "back";
			linux,code = <0x9e>;
			press-threshold-microvolt = <0x12d838>;
		};

		uboot-key {
			label = "uboot key";
			linux,code = <0x73>;
			press-threshold-microvolt = <0x30d40>;
		};
	};

	panel-edp0 {
		compatible = "simple-panel";
		backlight = <&backlight>;
		power-supply = <&vcc3v3_lcd>;
		prepare-delay-ms = <120>;
		enable-delay-ms = <120>;
		unprepare-delay-ms = <120>;
		disable-delay-ms = <120>;
		width-mm = <217>;   // 四舍五入物理尺寸
		height-mm = <136>;

		panel-timing {
			clock-frequency = <154000000>;   // eDP 时钟，约 154 MHz，可根据屏幕 datasheet 微调
			hactive = <1920>;
			vactive = <1200>;
			hfront-porch = <48>;
			hsync-len = <32>;
			hback-porch = <80>;
			vfront-porch = <3>;
			vsync-len = <5>;
			vback-porch = <15>;
			hsync-active = <0>;
			vsync-active = <0>;
			de-active = <0>;
			pixelclk-active = <0>;
		};

		port {
			panel_in_edp0: endpoint {
				remote-endpoint = <&edp0_out_panel>;
			};
		};
	};

	vcc3v3_lcd: vcc3v3-lcd {
		compatible = "regulator-fixed";
		regulator-name = "vcc3v3_lcd";
		vin-supply = <&vcc_3v3_s0>;
	};
};

&pinctrl {
	mcu {
		mcum0-pins {
			rockchip,pins = <0x04 0x1c 0x05 0x1a3 0x04 0x1d 0x05 0x1a3>;
		};

		mcum1-pins {
			rockchip,pins = <0x03 0x1c 0x06 0x1a3 0x03 0x1d 0x06 0x1a3>;
		};
	};

};

&dp0 {
	status = "disabled";
};

&hdmi0 {
	status = "disabled";
};

&route_hdmi0 {
	status = "disabled";
};


&hdptxphy_hdmi0 {
	status = "disabled";
};

&hdmi1 {
	status = "okay";
};

&route_hdmi1 {
	status = "okay";
};

&dp1 {
	status = "disabled";
};

&edp0 {
	force-hpd;
	phys = <&combphy2_psu PHY_TYPE_DP>;
	phy-names = "dp";
	status = "okay";
	ports {
		port@2 {
			reg = <1>;

			edp0_out_panel: endpoint {
				remote-endpoint = <&panel_in_edp0>;
			};
		};
	};
};

&edp1 {
	status = "disabled";
};

&route_edp0 {
	status = "okay";
	connect = <&vp2_out_edp0>;
};

&edp0_in_vp2 {
	status = "okay";
};

&dp0_in_vp2 {
	status = "okay";
};

&dp1_in_vp2 {
	status = "disabled";
};

&pcie2x1l0 {
	status = "disabled";
};

&pcie30phy {
	status = "disabled";
};

&pcie3x4 {
	status = "disabled";
};


&u2phy1_otg {
	status = "okay";
};

&u2phy2_host {
	status = "okay";
};

&u2phy3_host {
	status = "okay";
};
