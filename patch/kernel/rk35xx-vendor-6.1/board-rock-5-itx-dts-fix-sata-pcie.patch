From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Alban Browaeys <alban.browaeys@gmail.com>
Date: Thu, 7 Aug 2025 21:51:52 +0000
Subject: Fix PCI SATA link training instability on rock-5-itx

Based on upstream initial dts definition.

Signed-off-by: Alban Browaeys <alban.browaeys@gmail.com>
---
 arch/arm64/boot/dts/rockchip/rk3588-rock-5-itx.dts | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/arch/arm64/boot/dts/rockchip/rk3588-rock-5-itx.dts b/arch/arm64/boot/dts/rockchip/rk3588-rock-5-itx.dts
index 78e385e5d7bc..aa88daac6568 100644
--- a/arch/arm64/boot/dts/rockchip/rk3588-rock-5-itx.dts
+++ b/arch/arm64/boot/dts/rockchip/rk3588-rock-5-itx.dts
@@ -984,8 +994,10 @@ &pcie2x1l0 {
 };
 
 &pcie30phy {
+	/* separate clock lines from the clock generator to phy and devices */
+	rockchip,rx-common-refclk-mode = <0 0 0 0>;
 	rockchip,pcie30-phymode = <PHY_MODE_PCIE_NANBNB>;
 	status = "okay";
 };
 
 &pcie3x2 {
-- 
Armbian

