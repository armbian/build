From 31b5733e273d8e412a3d005ec62f25fab72a376a Mon Sep 17 00:00:00 2001
From: Frank Wunderlich <frank-w@public-files.de>
Date: Fri, 24 Oct 2025 19:28:09 +0200
Subject: [PATCH 082/116] dt-bindings: pinctrl: add binding for MT7987 SoC

This adds bindings for MT7987 pinctrl driver.

Signed-off-by: Frank Wunderlich <frank-w@public-files.de>
---
 .../pinctrl/mediatek,mt7987-pinctrl.yaml      | 453 ++++++++++++++++++
 1 file changed, 453 insertions(+)
 create mode 100644 Documentation/devicetree/bindings/pinctrl/mediatek,mt7987-pinctrl.yaml

diff --git a/Documentation/devicetree/bindings/pinctrl/mediatek,mt7987-pinctrl.yaml b/Documentation/devicetree/bindings/pinctrl/mediatek,mt7987-pinctrl.yaml
new file mode 100644
index 000000000000..eba4050ddf1d
--- /dev/null
+++ b/Documentation/devicetree/bindings/pinctrl/mediatek,mt7987-pinctrl.yaml
@@ -0,0 +1,453 @@
+# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
+%YAML 1.2
+---
+$id: http://devicetree.org/schemas/pinctrl/mediatek,mt7987-pinctrl.yaml#
+$schema: http://devicetree.org/meta-schemas/core.yaml#
+
+title: MediaTek MT7987 Pin Controller
+
+maintainers:
+  - Sean Wang <sean.wang@kernel.org>
+
+description:
+  The MediaTek's MT7987 Pin controller is used to control SoC pins.
+
+properties:
+  compatible:
+    enum:
+      - mediatek,mt7987-pinctrl
+
+  reg:
+    minItems: 7
+    maxItems: 7
+
+  reg-names:
+    items:
+      - const: gpio
+      - const: iocfg_rb
+      - const: iocfg_lb
+      - const: iocfg_rt1
+      - const: iocfg_rt2
+      - const: iocfg_tl
+      - const: eint
+
+  gpio-controller: true
+
+  "#gpio-cells":
+    const: 2
+
+  gpio-ranges:
+    minItems: 1
+    maxItems: 5
+    description:
+      GPIO valid number range.
+
+  interrupt-controller: true
+
+  interrupts:
+    maxItems: 1
+
+  "#interrupt-cells":
+    const: 2
+
+allOf:
+  - $ref: pinctrl.yaml#
+
+required:
+  - compatible
+  - reg
+  - reg-names
+  - gpio-controller
+  - "#gpio-cells"
+
+patternProperties:
+  "-hog(-[0-9]+)?$":
+    type: object
+    required:
+      - gpio-hog
+
+  '-pins$':
+    type: object
+    additionalProperties: false
+
+    properties:
+      mux:
+        type: object
+        additionalProperties: false
+        $ref: /schemas/pinctrl/pinmux-node.yaml
+        description: |
+          pinmux configuration nodes.
+
+          The following table shows the effective values of "group", "function"
+          properties and chip pinout pins
+
+          groups               function           pins (in pin#)
+          ---------------------------------------------------------------------
+          "2p5gbe_led0"        "led"              45
+          "2p5gbe_led1_0"      "led"              13
+          "2p5gbe_led1_1"      "led"              49
+          "2p5g_ext_mdc_mdio"  "ethernet"         23, 24
+          "drv_vbus"           "usb"              48
+          "drv_vbus_p1"        "usb"              14
+          "emmc_45"            "flash"            14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24
+          "i2c0_0"             "i2c"              29, 30
+          "i2c0_1"             "i2c"              39, 40
+          "i2c0_2"             "i2c"              43, 44
+          "jtag"               "jtag"             3, 4, 5, 6, 7
+          "mdc_mdio"           "ethernet"         39, 40
+          "pcie0_clkreq"       "pcie"             34
+          "pcie0_pereset"      "pcie"             33
+          "pcie0_wake"         "pcie"             35
+          "pcie1_clkreq"       "pcie"             37
+          "pcie1_pereset"      "pcie"             36
+          "pcie1_wake"         "pcie"             38
+          "pcie_phy_i2c"       "pcie"             43, 44
+          "pcm0_0"             "pcm"              3, 4, 5, 6, 7
+          "pcm0_1"             "pcm"              8, 9, 10, 11, 12
+          "pwm0"               "pwm"              13
+          "pwm1_0"             "pwm"              7
+          "pwm1_1"             "pwm"              43
+          "pwm2_0"             "pwm"              12
+          "pwm2_1"             "pwm"              44
+          "sd"                 "flash"            15, 16, 17, 18, 23, 24
+          "spi0"               "spi"              15, 16, 17, 18
+          "spi0_wp_hold"       "spi"              19, 20
+          "spi1_1"             "spi"              46, 47, 48, 49
+          "spi1"               "spi"              21, 22, 23, 24
+          "spi2"               "spi"              25, 26, 27, 28
+          "spi2_wp_hold"       "spi"              29, 30
+          "uart0"              "uart"             31, 32
+          "uart1_0_lite"       "uart"             3, 4
+          "uart1_0"            "uart"             3, 4, 5, 6
+          "uart1_1"            "uart"             21, 22, 23, 24
+          "uart1_2"            "uart"             46, 47, 48, 49
+          "uart2_0"            "uart"             8, 9, 10, 11
+          "uart2_1"            "uart"             25, 26, 27, 28
+          "watchdog"           "wdt"              2
+
+        properties:
+          function:
+            description:
+              A string containing the name of the function to mux to the group.
+            enum: [eth, flash, i2c, i2s, led, pcie, pcm, pwm, jtag, spi, uart, usb, wdt]
+          groups:
+            description:
+              An array of strings. Each string contains the name of a group.
+
+        required:
+          - function
+          - groups
+
+        allOf:
+          - if:
+              properties:
+                function:
+                  const: jtag
+            then:
+              properties:
+                groups:
+                  const: jtag
+          - if:
+              properties:
+                function:
+                  const: flash
+            then:
+              properties:
+                groups:
+                  enum: [emmc_45, sd]
+          - if:
+              properties:
+                function:
+                  const: ethernet
+            then:
+              properties:
+                groups:
+                  enum: [2p5g_ext_mdc_mdio, mdc_mdio]
+          - if:
+              properties:
+                function:
+                  const: i2c
+            then:
+              properties:
+                groups:
+                  enum: [i2c0_0, i2c0_1, i2c0_2]
+          - if:
+              properties:
+                function:
+                  const: led
+            then:
+              properties:
+                groups:
+                  enum: [2p5gbe_led0, 2p5gbe_led1_0, 2p5gbe_led1_1]
+          - if:
+              properties:
+                function:
+                  const: pcie
+            then:
+              properties:
+                groups:
+                  items:
+                    enum: [pcie0_clkreq, pcie0_pereset, pcie0_wake, pcie1_clkreq, pcie1_pereset, pcie1_wake,
+                           pcie_phy_i2c]
+                  maxItems: 3
+          - if:
+              properties:
+                function:
+                  const: pwm
+            then:
+              properties:
+                groups:
+                  items:
+                    enum: [pwm0, pwm1_0, pwm1_1, pwm2_0, pwm2_1]
+                  maxItems: 3
+          - if:
+              properties:
+                function:
+                  const: spi
+            then:
+              properties:
+                groups:
+                  items:
+                    enum: [spi0, spi0_wp_hold, spi1_1, spi1, spi2, spi2_wp_hold]
+                  maxItems: 2
+          - if:
+              properties:
+                function:
+                  const: uart
+            then:
+              properties:
+                groups:
+                  items:
+                    enum: [uart0, uart1_0_lite, uart1_0, uart1_1, uart1_2,
+                           uart2_0, uart2_1]
+                  maxItems: 2
+          - if:
+              properties:
+                function:
+                  const: wdt
+            then:
+              properties:
+                groups:
+                  const: watchdog
+          - if:
+              properties:
+                function:
+                  const: usb
+            then:
+              properties:
+                groups:
+                  items:
+                    enum: [drv_vbus, drv_vbus_p1]
+                  maxItems: 1
+
+    patternProperties:
+      '^conf(-[-a-z]*)?$':
+        type: object
+        additionalProperties: false
+        description:
+          pinconf configuration nodes.
+        $ref: /schemas/pinctrl/pincfg-node.yaml
+
+        properties:
+          pins:
+            description:
+              An array of strings. Each string contains the name of a pin.
+            items:
+              enum: [GPIO_WPS, GPIO_RESET, SYS_WATCHDOG, JTAG_JTDO, JTAG_JTDI,
+                     JTAG_JTMS, JTAG_JTCLK, JTAG_JTRST_N, PCM_DTX_I2S_DOUT,
+                     PCM_DRX_I2S_DIN, PCM_CLK_I2S_BCLK, PCM_FS_I2S_LRCK,
+                     PCM_MCK_I2S_MCLK, PWM0, USB_VBUS, SPI0_CLK, SPI0_MOSI,
+                     SPI0_MISO, SPI0_CS, SPI0_HOLD, SPI0_WP, SPI1_CLK,
+                     SPI1_MOSI, SPI1_MISO, SPI1_CS, SPI2_CLK, SPI2_MOSI,
+                     SPI2_MISO, SPI2_CS, SPI2_HOLD, SPI2_WP, UART0_RXD,
+                     UART0_TXD, PCIE_PERESET_N_0, PCIE_CLK_REQ_0,
+                     PCIE_WAKE_N_0, PCIE_PERESET_N_1, PCIE_CLK_REQ_1,
+                     PCIE_WAKE_N_1, SMI_MDC, SMI_MDIO, GBE_INT, GBE_RESET,
+                     I2C_SCLK, I2C_SDATA, 2P5G_LED0, UART1_RXD, UART1_TXD,
+                     UART1_CTS, UART1_RTS]
+            maxItems: 50
+
+          bias-disable: true
+
+          bias-pull-up:
+            oneOf:
+              - type: boolean
+                description: normal pull up.
+              - enum: [100, 101, 102, 103]
+                description:
+                  PUPD/R1/R0 pull down type. See MTK_PUPD_SET_R1R0 defines in
+                  dt-bindings/pinctrl/mt65xx.h.
+
+          bias-pull-down:
+            oneOf:
+              - type: boolean
+                description: normal pull down.
+              - enum: [100, 101, 102, 103]
+                description:
+                  PUPD/R1/R0 pull down type. See MTK_PUPD_SET_R1R0 defines in
+                  dt-bindings/pinctrl/mt65xx.h.
+
+          input-enable: true
+
+          input-disable: true
+
+          output-enable: true
+
+          output-low: true
+
+          output-high: true
+
+          input-schmitt-enable: true
+
+          input-schmitt-disable: true
+
+          drive-strength:
+            enum: [2, 4, 6, 8, 10, 12, 14, 16]
+
+          mediatek,pull-up-adv:
+            description: |
+              Valid arguments for 'mediatek,pull-up-adv' are '0', '1', '2', '3'
+              Pull up settings for 2 pull resistors, R0 and R1. Valid arguments
+              are described as below:
+              0: (R1, R0) = (0, 0) which means R1 disabled and R0 disabled.
+              1: (R1, R0) = (0, 1) which means R1 disabled and R0 enabled.
+              2: (R1, R0) = (1, 0) which means R1 enabled and R0 disabled.
+              3: (R1, R0) = (1, 1) which means R1 enabled and R0 enabled.
+            $ref: /schemas/types.yaml#/definitions/uint32
+            enum: [0, 1, 2, 3]
+
+          mediatek,pull-down-adv:
+            description: |
+              Valid arguments for 'mediatek,pull-up-adv' are '0', '1', '2', '3'
+              Pull down settings for 2 pull resistors, R0 and R1. Valid arguments
+              are described as below:
+              0: (R1, R0) = (0, 0) which means R1 disabled and R0 disabled.
+              1: (R1, R0) = (0, 1) which means R1 disabled and R0 enabled.
+              2: (R1, R0) = (1, 0) which means R1 enabled and R0 disabled.
+              3: (R1, R0) = (1, 1) which means R1 enabled and R0 enabled.
+            $ref: /schemas/types.yaml#/definitions/uint32
+            enum: [0, 1, 2, 3]
+
+        required:
+          - pins
+
+additionalProperties: false
+
+examples:
+  - |
+    #include <dt-bindings/interrupt-controller/irq.h>
+    #include <dt-bindings/interrupt-controller/arm-gic.h>
+    #include <dt-bindings/pinctrl/mt65xx.h>
+
+    soc {
+      #address-cells = <2>;
+      #size-cells = <2>;
+
+      pio: pinctrl@1001f000 {
+        compatible = "mediatek,mt7987-pinctrl";
+        reg = <0 0x1001f000 0 0x1000>,
+          <0 0x11d00000 0 0x1000>,
+          <0 0x11e00000 0 0x1000>,
+          <0 0x11f00000 0 0x1000>,
+          <0 0x11f40000 0 0x1000>,
+          <0 0x11f60000 0 0x1000>,
+          <0 0x1000b000 0 0x1000>;
+        reg-names = "gpio", "iocfg_rb", "iocfg_lb", "iocfg_rt1",
+          "iocfg_rt2", "iocfg_tl", "eint";
+        gpio-controller;
+        #gpio-cells = <2>;
+        gpio-ranges = <&pio 0 0 50>;
+        interrupt-controller;
+        interrupts = <GIC_SPI 225 IRQ_TYPE_LEVEL_HIGH>;
+        interrupt-parent = <&gic>;
+        #interrupt-cells = <2>;
+
+        mmc_pins_default: mmc-default-pins {
+          mux {
+            function = "flash";
+            groups = "emmc_45";
+          };
+          conf-cmd-dat {
+            pins = "SPI0_CLK", "SPI0_MOSI", "SPI0_MISO",
+              "SPI0_CS", "SPI0_HOLD", "SPI0_WP",
+              "SPI1_CLK", "SPI1_MOSI", "SPI1_MISO";
+            input-enable;
+            drive-strength = <4>;
+            mediatek,pull-up-adv = <1>; /* pull-up 10K */
+          };
+          conf-clk {
+            pins = "SPI1_CS";
+            drive-strength = <6>;
+            mediatek,pull-down-adv = <2>; /* pull-down 50K */
+          };
+          conf-rst {
+            pins = "USB_VBUS";
+            drive-strength = <4>;
+            mediatek,pull-up-adv = <1>; /* pull-up 10K */
+          };
+        };
+        mdio0_pins: mdio0-pins {
+          mux {
+            function = "eth";
+            groups = "mdc_mdio";
+          };
+          conf {
+            groups = "mdc_mdio";
+            drive-strength = <6>;
+          };
+        };
+        i2p5gbe_led0_pins: i2p5gbe0-pins {
+          mux {
+           function = "led";
+           groups = "2p5gbe_led0";
+          };
+        };
+
+        i2c0_pins: i2c0-g2-pins {
+          mux {
+            function = "i2c";
+            groups = "i2c0_2";
+          };
+        };
+
+        pcie0_pins: pcie0-pins {
+          mux {
+            function = "pcie";
+            groups = "pcie0_pereset", "pcie0_clkreq",
+              "pcie0_wake";
+          };
+        };
+
+        spi0_flash_pins: spi0-pins {
+          mux {
+            function = "spi";
+            groups = "spi0", "spi0_wp_hold";
+          };
+          conf-pu {
+            pins = "SPI0_CS", "SPI0_HOLD", "SPI0_WP";
+            drive-strength = <4>;
+            bias-pull-up = <103>;
+          };
+          conf-pd {
+            pins = "SPI0_CLK", "SPI0_MOSI", "SPI0_MISO";
+            drive-strength = <4>;
+            bias-pull-down = <103>;
+          };
+        };
+
+        pwm_pins: pwm-pins {
+          mux {
+            function = "pwm";
+            groups = "pwm0";
+          };
+        };
+
+        uart0_pins: uart0-pins {
+          mux {
+            function = "uart";
+            groups = "uart0";
+          };
+        };
+
+      };
+    };
-- 
2.39.5

