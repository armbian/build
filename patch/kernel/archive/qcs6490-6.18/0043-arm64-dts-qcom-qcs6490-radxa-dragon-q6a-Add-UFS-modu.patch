From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Xilin Wu <sophon@radxa.com>
Date: Fri, 25 Jul 2025 12:50:23 +0800
Subject: arm64: dts: qcom: qcs6490-radxa-dragon-q6a: Add UFS module detection
 gpio

Signed-off-by: Xilin Wu <sophon@radxa.com>
---
 arch/arm64/boot/dts/qcom/qcs6490-radxa-dragon-q6a.dts | 11 ++++++++++
 1 file changed, 11 insertions(+)

diff --git a/arch/arm64/boot/dts/qcom/qcs6490-radxa-dragon-q6a.dts b/arch/arm64/boot/dts/qcom/qcs6490-radxa-dragon-q6a.dts
index 111111111111..222222222222 100644
--- a/arch/arm64/boot/dts/qcom/qcs6490-radxa-dragon-q6a.dts
+++ b/arch/arm64/boot/dts/qcom/qcs6490-radxa-dragon-q6a.dts
@@ -1256,6 +1256,7 @@ &uart5 {
 };
 
 &ufs_mem_hc {
+	cd-gpios = <&tlmm 7 GPIO_ACTIVE_LOW>;
 	reset-gpios = <&tlmm 175 GPIO_ACTIVE_LOW>;
 	vcc-supply = <&vreg_l7b_2p96>;
 	vcc-max-microamp = <800000>;
@@ -1264,6 +1265,9 @@ &ufs_mem_hc {
 	vccq2-supply = <&vreg_l9b_1p2>;
 	vccq2-max-microamp = <1300000>;
 
+	pinctrl-0 = <&ufs_cd>;
+	pinctrl-names = "default";
+
 	/delete-property/ qcom,ice;
 
 	status = "okay";
@@ -1402,6 +1406,13 @@ sd_cd: sd-cd-state {
 		bias-pull-up;
 	};
 
+	ufs_cd: ufs-cd-state {
+		pins = "gpio7";
+		function = "gpio";
+		drive-strength = <2>;
+		bias-pull-up;
+	};
+
 	user_led: user-led-state {
 		pins = "gpio42";
 		function = "gpio";
-- 
Armbian

