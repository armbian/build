From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Xilin Wu <sophon@radxa.com>
Date: Wed, 23 Jul 2025 11:51:46 +0800
Subject: arm64: dts: qcom: qcs6490-radxa-dragon-q6a: Optimize regulator
 settings

Signed-off-by: Xilin Wu <sophon@radxa.com>
---
 arch/arm64/boot/dts/qcom/qcs6490-radxa-dragon-q6a.dts | 339 +++++-----
 1 file changed, 168 insertions(+), 171 deletions(-)

diff --git a/arch/arm64/boot/dts/qcom/qcs6490-radxa-dragon-q6a.dts b/arch/arm64/boot/dts/qcom/qcs6490-radxa-dragon-q6a.dts
index 111111111111..222222222222 100644
--- a/arch/arm64/boot/dts/qcom/qcs6490-radxa-dragon-q6a.dts
+++ b/arch/arm64/boot/dts/qcom/qcs6490-radxa-dragon-q6a.dts
@@ -281,85 +281,85 @@ regulators-0 {
 		vdd-s6-supply = <&vph_pwr>;
 		vdd-s7-supply = <&vph_pwr>;
 		vdd-s8-supply = <&vph_pwr>;
-		vdd-l1-l4-l12-l15-supply = <&vreg_s7b_0p972>;
+		vdd-l1-l4-l12-l15-supply = <&vreg_s7b_0p536>;
 		vdd-l2-l7-supply = <&vreg_bob_3p296>;
-		vdd-l3-supply = <&vreg_s2b_0p876>;
-		vdd-l5-supply = <&vreg_s2b_0p876>;
-		vdd-l6-l9-l10-supply = <&vreg_s8b_1p272>;
-		vdd-l8-supply = <&vreg_s7b_0p972>;
-		vdd-l11-l17-l18-l19-supply = <&vreg_s1b_1p872>;
-		vdd-l13-supply = <&vreg_s7b_0p972>;
-		vdd-l14-l16-supply = <&vreg_s8b_1p272>;
-
-		vreg_s1b_1p872: smps1 {
-			regulator-name = "vreg_s1b_1p872";
+		vdd-l3-supply = <&vreg_s2b_0p572>;
+		vdd-l5-supply = <&vreg_s2b_0p572>;
+		vdd-l6-l9-l10-supply = <&vreg_s8b_1p2>;
+		vdd-l8-supply = <&vreg_s7b_0p536>;
+		vdd-l11-l17-l18-l19-supply = <&vreg_s1b_1p84>;
+		vdd-l13-supply = <&vreg_s7b_0p536>;
+		vdd-l14-l16-supply = <&vreg_s8b_1p2>;
+
+		vreg_s1b_1p84: smps1 {
+			regulator-name = "vreg_s1b_1p84";
 			regulator-min-microvolt = <1840000>;
 			regulator-max-microvolt = <2040000>;
 		};
 
-		vreg_s2b_0p876: smps2 {
-			regulator-name = "vreg_s2b_0p876";
-			regulator-min-microvolt = <570070>;
-			regulator-max-microvolt = <1050000>;
+		vreg_s2b_0p572: smps2 {
+			regulator-name = "vreg_s2b_0p572";
+			regulator-min-microvolt = <572000>;
+			regulator-max-microvolt = <1048000>;
 		};
 
-		vreg_s7b_0p972: smps7 {
-			regulator-name = "vreg_s7b_0p972";
-			regulator-min-microvolt = <535000>;
+		vreg_s7b_0p536: smps7 {
+			regulator-name = "vreg_s7b_0p536";
+			regulator-min-microvolt = <536000>;
 			regulator-max-microvolt = <1120000>;
 		};
 
-		vreg_s8b_1p272: smps8 {
-			regulator-name = "vreg_s8b_1p272";
+		vreg_s8b_1p2: smps8 {
+			regulator-name = "vreg_s8b_1p2";
 			regulator-min-microvolt = <1200000>;
-			regulator-max-microvolt = <1500000>;
+			regulator-max-microvolt = <1496000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
 		};
 
 		vreg_l1b_0p912: ldo1 {
 			regulator-name = "vreg_l1b_0p912";
-			regulator-min-microvolt = <825000>;
-			regulator-max-microvolt = <925000>;
+			regulator-min-microvolt = <832000>;
+			regulator-max-microvolt = <920000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
 
 		vreg_l2b_3p072: ldo2 {
 			regulator-name = "vreg_l2b_3p072";
-			regulator-min-microvolt = <2700000>;
+			regulator-min-microvolt = <2704000>;
 			regulator-max-microvolt = <3544000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
 
-		vreg_l3b_0p504: ldo3 {
-			regulator-name = "vreg_l3b_0p504";
-			regulator-min-microvolt = <312000>;
-			regulator-max-microvolt = <650000>;
+		vreg_l3b_0p32: ldo3 {
+			regulator-name = "vreg_l3b_0p32";
+			regulator-min-microvolt = <320000>;
+			regulator-max-microvolt = <904000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
 
 		vreg_l4b_0p752: ldo4 {
 			regulator-name = "vreg_l4b_0p752";
-			regulator-min-microvolt = <465000>;
-			regulator-max-microvolt = <1050000>;
+			regulator-min-microvolt = <752000>;
+			regulator-max-microvolt = <816000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
 
-		reg_l5b_0p752: ldo5 {
-			regulator-name = "reg_l5b_0p752";
-			regulator-min-microvolt = <435000>;
-			regulator-max-microvolt = <1100000>;
+		vreg_l5b_0p44: ldo5 {
+			regulator-name = "vreg_l5b_0p44";
+			regulator-min-microvolt = <440000>;
+			regulator-max-microvolt = <832000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
 
 		vreg_l6b_1p2: ldo6 {
 			regulator-name = "vreg_l6b_1p2";
 			regulator-min-microvolt = <1200000>;
-			regulator-max-microvolt = <1260000>;
+			regulator-max-microvolt = <1256000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
 
-		vreg_l7b_3p0: ldo7 {
-			regulator-name = "vreg_l7b_3p0";
+		vreg_l7b_2p96: ldo7 {
+			regulator-name = "vreg_l7b_2p96";
 			regulator-min-microvolt = <2960000>;
 			regulator-max-microvolt = <2960000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
@@ -368,86 +368,76 @@ vreg_l7b_3p0: ldo7 {
 							RPMH_REGULATOR_MODE_HPM>;
 		};
 
-		vreg_l8b_0p904: ldo8 {
-			regulator-name = "vreg_l8b_0p904";
-			regulator-min-microvolt = <870000>;
-			regulator-max-microvolt = <970000>;
+		vreg_l8b_0p872: ldo8 {
+			regulator-name = "vreg_l8b_0p872";
+			regulator-min-microvolt = <872000>;
+			regulator-max-microvolt = <968000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
 
-		// vreg_l9b_1p2: ldo9 {
-		// 	regulator-name = "vreg_l9b_1p2";
-		// 	regulator-min-microvolt = <1080000>;
-		// 	regulator-max-microvolt = <1304000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// 	regulator-allow-set-load;
-		// 	regulator-allowed-modes = <RPMH_REGULATOR_MODE_LPM
-		// 				   RPMH_REGULATOR_MODE_HPM>;
-		// };
 		vreg_l9b_1p2: ldo9 {
 			regulator-name = "vreg_l9b_1p2";
-			// regulator-min-microvolt = <1200000>;
-			// regulator-max-microvolt = <1200000>;
+			regulator-min-microvolt = <1200000>;
+			regulator-max-microvolt = <1304000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 			regulator-allow-set-load;
 			regulator-allowed-modes = <RPMH_REGULATOR_MODE_LPM
 						   RPMH_REGULATOR_MODE_HPM>;
 		};
 
-		// vreg_l11b_1p504: ldo11 {
-		// 	regulator-name = "vreg_l11b_1p504";
-		// 	regulator-min-microvolt = <1504000>;
-		// 	regulator-max-microvolt = <2000000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
-
-		// vreg_l12b_0p751: ldo12 {
-		// 	regulator-name = "vreg_l12b_0p751";
-		// 	regulator-min-microvolt = <751000>;
-		// 	regulator-max-microvolt = <824000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
-
-		// vreg_l13b_0p53: ldo13 {
-		// 	regulator-name = "vreg_l13b_0p53";
-		// 	regulator-min-microvolt = <530000>;
-		// 	regulator-max-microvolt = <824000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
-
-		// vreg_l14b_1p08: ldo14 {
-		// 	regulator-name = "vreg_l14b_1p08";
-		// 	regulator-min-microvolt = <1080000>;
-		// 	regulator-max-microvolt = <1304000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
-
-		// vreg_l15b_0p765: ldo15 {
-		// 	regulator-name = "vreg_l15b_0p765";
-		// 	regulator-min-microvolt = <765000>;
-		// 	regulator-max-microvolt = <1020000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
-
-		// vreg_l16b_1p1: ldo16 {
-		// 	regulator-name = "vreg_l16b_1p1";
-		// 	regulator-min-microvolt = <1100000>;
-		// 	regulator-max-microvolt = <1300000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
+		vreg_l11b_1p504: ldo11 {
+			regulator-name = "vreg_l11b_1p504";
+			regulator-min-microvolt = <1504000>;
+			regulator-max-microvolt = <2000000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
+
+		vreg_l12b_0p752: ldo12 {
+			regulator-name = "vreg_l12b_0p752";
+			regulator-min-microvolt = <752000>;
+			regulator-max-microvolt = <824000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
+
+		vreg_l13b_0p53: ldo13 {
+			regulator-name = "vreg_l13b_0p53";
+			regulator-min-microvolt = <536000>;
+			regulator-max-microvolt = <824000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
+
+		vreg_l14b_1p08: ldo14 {
+			regulator-name = "vreg_l14b_1p08";
+			regulator-min-microvolt = <1080000>;
+			regulator-max-microvolt = <1304000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
+
+		vreg_l15b_0p768: ldo15 {
+			regulator-name = "vreg_l15b_0p768";
+			regulator-min-microvolt = <768000>;
+			regulator-max-microvolt = <1016000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
+
+		vreg_l16b_1p1: ldo16 {
+			regulator-name = "vreg_l16b_1p1";
+			regulator-min-microvolt = <1104000>;
+			regulator-max-microvolt = <1296000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
 
 		vreg_l17b_1p8: ldo17 {
 			regulator-name = "vreg_l17b_1p8";
 			regulator-min-microvolt = <1800000>;
-			regulator-max-microvolt = <1800000>;
+			regulator-max-microvolt = <1896000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-			regulator-always-on;
 		};
 
 		vreg_l18b_1p8: ldo18 {
 			regulator-name = "vreg_l18b_1p8";
 			regulator-min-microvolt = <1800000>;
-			regulator-max-microvolt = <1800000>;
+			regulator-max-microvolt = <2000000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 			regulator-always-on;
 		};
@@ -456,7 +446,7 @@ vreg_l19b_1p8: ldo19 {
 			regulator-name = "vreg_l19b_1p8";
 			regulator-min-microvolt = <1800000>;
 			regulator-max-microvolt = <2000000>;
-			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
 		};
 	};
 
@@ -474,76 +464,78 @@ regulators-1 {
 		vdd-s8-supply = <&vph_pwr>;
 		vdd-s9-supply = <&vph_pwr>;
 		vdd-s10-supply = <&vph_pwr>;
-		vdd-l1-l12-supply = <&vreg_s1b_1p872>;
-		vdd-l2-l8-supply = <&vreg_s1b_1p872>;
+		vdd-l1-l12-supply = <&vreg_s1b_1p84>;
+		vdd-l2-l8-supply = <&vreg_s1b_1p84>;
 		vdd-l3-l4-l5-l7-l13-supply = <&vreg_bob_3p296>;
 		vdd-l6-l9-l11-supply = <&vreg_bob_3p296>;
-		vdd-l10-supply = <&vreg_s7b_0p972>;
+		vdd-l10-supply = <&vreg_s7b_0p536>;
 		vdd-bob-supply = <&vph_pwr>;
 
-		// vreg_s1c_2p19: smps1 {
-		// 	regulator-name = "vreg_s1c_2p19";
-		// 	regulator-min-microvolt = <2190000>;
-		// 	regulator-max-microvolt = <2210000>;
-		// };
+		vreg_s1c_2p19: smps1 {
+			regulator-name = "vreg_s1c_2p19";
+			regulator-min-microvolt = <2192000>;
+			regulator-max-microvolt = <2208000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
 
 		vreg_s2c_0p752: smps2 {
 			regulator-name = "vreg_s2c_0p752";
-			regulator-min-microvolt = <750000>;
+			regulator-min-microvolt = <752000>;
 			regulator-max-microvolt = <800000>;
 		};
 
-		vreg_s5c_0p752: smps5 {
-			regulator-name = "vreg_s5c_0p752";
-			regulator-min-microvolt = <465000>;
-			regulator-max-microvolt = <1050000>;
+		vreg_s5c_0p468: smps5 {
+			regulator-name = "vreg_s5c_0p468";
+			regulator-min-microvolt = <468000>;
+			regulator-max-microvolt = <1048000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
 		};
 
-		vreg_s7c_0p752: smps7 {
-			regulator-name = "vreg_s7c_0p752";
-			regulator-min-microvolt = <465000>;
+		vreg_s7c_0p468: smps7 {
+			regulator-name = "vreg_s7c_0p468";
+			regulator-min-microvolt = <468000>;
 			regulator-max-microvolt = <800000>;
 		};
 
-		vreg_s9c_1p084: smps9 {
-			regulator-name = "vreg_s9c_1p084";
-			regulator-min-microvolt = <1010000>;
-			regulator-max-microvolt = <1170000>;
+		vreg_s9c_1p012: smps9 {
+			regulator-name = "vreg_s9c_1p012";
+			regulator-min-microvolt = <1012000>;
+			regulator-max-microvolt = <1168000>;
 		};
 
 		vreg_l1c_1p8: ldo1 {
 			regulator-name = "vreg_l1c_1p8";
 			regulator-min-microvolt = <1800000>;
-			regulator-max-microvolt = <1980000>;
+			regulator-max-microvolt = <1976000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
 
-		// vreg_l2c_1p62: ldo2 {
-		// 	regulator-name = "vreg_l2c_1p62";
-		// 	regulator-min-microvolt = <1620000>;
-		// 	regulator-max-microvolt = <1980000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
+		vreg_l2c_1p8: ldo2 {
+			regulator-name = "vreg_l2c_1p8";
+			regulator-min-microvolt = <1624000>;
+			regulator-max-microvolt = <1976000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
 
-		// vreg_l3c_2p8: ldo3 {
-		// 	regulator-name = "vreg_l3c_2p8";
-		// 	regulator-min-microvolt = <2800000>;
-		// 	regulator-max-microvolt = <3540000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
+		vreg_l3c_3p0: ldo3 {
+			regulator-name = "vreg_l3c_3p0";
+			regulator-min-microvolt = <2800000>;
+			regulator-max-microvolt = <3536000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
 
 		vreg_l4c_1p62: ldo4 {
 			regulator-name = "vreg_l4c_1p62";
-			regulator-min-microvolt = <1620000>;
-			regulator-max-microvolt = <3300000>;
-			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
+			regulator-min-microvolt = <1624000>;
+			regulator-max-microvolt = <3296000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
 		};
 
 		vreg_l5c_1p62: ldo5 {
 			regulator-name = "vreg_l5c_1p62";
-			regulator-min-microvolt = <1620000>;
-			regulator-max-microvolt = <3300000>;
-			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
+			regulator-min-microvolt = <1624000>;
+			regulator-max-microvolt = <3296000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
 		};
 
 		vreg_l6c_2p96: ldo6 {
@@ -551,62 +543,67 @@ vreg_l6c_2p96: ldo6 {
 			regulator-min-microvolt = <1650000>;
 			regulator-max-microvolt = <3544000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
+			regulator-allow-set-load;
+			regulator-allowed-modes = <RPMH_REGULATOR_MODE_LPM
+						   RPMH_REGULATOR_MODE_HPM>;
 		};
 
-		// vreg_l7c_3p0: ldo7 {
-		// 	regulator-name = "vreg_l7c_3p0";
-		// 	regulator-min-microvolt = <3000000>;
-		// 	regulator-max-microvolt = <3544000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
+		vreg_l7c_3p0: ldo7 {
+			regulator-name = "vreg_l7c_3p0";
+			regulator-min-microvolt = <3000000>;
+			regulator-max-microvolt = <3544000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
 
-		// vreg_l8c_1p62: ldo8 {
-		// 	regulator-name = "vreg_l8c_1p62";
-		// 	regulator-min-microvolt = <1620000>;
-		// 	regulator-max-microvolt = <2000000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
+		vreg_l8c_1p8: ldo8 {
+			regulator-name = "vreg_l8c_1p8";
+			regulator-min-microvolt = <1624000>;
+			regulator-max-microvolt = <2000000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
 
 		vreg_l9c_2p96: ldo9 {
 			regulator-name = "vreg_l9c_2p96";
-			regulator-min-microvolt = <2700000>;
+			regulator-min-microvolt = <2704000>;
 			regulator-max-microvolt = <3544000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
+			regulator-allow-set-load;
+			regulator-allowed-modes = <RPMH_REGULATOR_MODE_LPM
+						   RPMH_REGULATOR_MODE_HPM>;
 		};
 
 		vreg_l10c_0p88: ldo10 {
 			regulator-name = "vreg_l10c_0p88";
 			regulator-min-microvolt = <720000>;
-			regulator-max-microvolt = <1050000>;
+			regulator-max-microvolt = <1048000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
 
-		// vreg_l11c_2p8: ldo11 {
-		// 	regulator-name = "vreg_l11c_2p8";
-		// 	regulator-min-microvolt = <2800000>;
-		// 	regulator-max-microvolt = <3544000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
+		vreg_l11c_2p8: ldo11 {
+			regulator-name = "vreg_l11c_2p8";
+			regulator-min-microvolt = <2800000>;
+			regulator-max-microvolt = <3544000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
 
-		// vreg_l12c_1p65: ldo12 {
-		// 	regulator-name = "vreg_l12c_1p65";
-		// 	regulator-min-microvolt = <1650000>;
-		// 	regulator-max-microvolt = <2000000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
+		vreg_l12c_1p8: ldo12 {
+			regulator-name = "vreg_l12c_1p8";
+			regulator-min-microvolt = <1656000>;
+			regulator-max-microvolt = <2000000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
 
-		// vreg_l13c_2p7: ldo13 {
-		// 	regulator-name = "vreg_l13c_2p7";
-		// 	regulator-min-microvolt = <2700000>;
-		// 	regulator-max-microvolt = <3544000>;
-		// 	regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
-		// };
+		vreg_l13c_3p0: ldo13 {
+			regulator-name = "vreg_l13c_2p7";
+			regulator-min-microvolt = <2704000>;
+			regulator-max-microvolt = <3544000>;
+			regulator-initial-mode = <RPMH_REGULATOR_MODE_RET>;
+		};
 
 		vreg_bob_3p296: bob {
 			regulator-name = "vreg_bob_3p296";
-			regulator-min-microvolt = <3008000>;
+			regulator-min-microvolt = <3032000>;
 			regulator-max-microvolt = <3960000>;
-			regulator-always-on;
 		};
 	};
 };
@@ -1260,7 +1257,7 @@ &uart5 {
 
 &ufs_mem_hc {
 	reset-gpios = <&tlmm 175 GPIO_ACTIVE_LOW>;
-	vcc-supply = <&vreg_l7b_3p0>;
+	vcc-supply = <&vreg_l7b_2p96>;
 	vcc-max-microamp = <800000>;
 	vccq-supply = <&vreg_l9b_1p2>;
 	vccq-max-microamp = <900000>;
-- 
Armbian

