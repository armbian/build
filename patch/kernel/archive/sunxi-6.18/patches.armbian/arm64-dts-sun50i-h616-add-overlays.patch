From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Werner <werner@armbian.com>
Date: Tue, 30 May 2023 12:04:55 +0800
Subject: sun50i-h616: add overlays and fixup

Author: unknown
Signed-off-by: Werner <werner@armbian.com>
---
 scripts/Makefile.lib | 11 ++++++++++
 1 file changed, 11 insertions(+)

diff --git a/scripts/Makefile.lib b/scripts/Makefile.lib
index 111111111111..222222222222 100644
--- a/scripts/Makefile.lib
+++ b/scripts/Makefile.lib
@@ -366,6 +366,15 @@ quiet_cmd_lz4_with_size = LZ4     $@
       cmd_lz4_with_size = { cat $(real-prereqs) | $(LZ4) -l -9 - -; \
                   $(size_append); } > $@
 
+# Fixup script mkimage provided by Armbian
+# ---------------------------------------------------------------------------
+
+quiet_cmd_scr = FIXUP IMAGE $@
+      cmd_scr = mkimage -C none -A $(ARCH) -T script -d $< $@
+
+$(obj)/%.scr: $(src)/%.scr-cmd FORCE
+	$(call if_changed,scr)
+
 # U-Boot mkimage
 # ---------------------------------------------------------------------------
 
@@ -489,3 +498,5 @@ define filechk_offsets
 	 echo ""; \
 	 echo "#endif"
 endef
+
+extra-y				+= $(scr-y) $(dtbotxt-y)
-- 
Armbian

