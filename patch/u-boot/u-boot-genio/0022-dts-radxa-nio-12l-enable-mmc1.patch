From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Julien Massot <julien.massot@collabora.com>
Date: Fri, 7 Mar 2025 10:05:08 +0100
Subject: dts: radxa-nio-12l: enable mmc1

Enable mmc1 so we have sdcard enabled in u-boot
---
 arch/arm/dts/genio-1200-radxa-nio-12l.dtsi | 43 ++++++++++
 1 file changed, 43 insertions(+)

diff --git a/arch/arm/dts/genio-1200-radxa-nio-12l.dtsi b/arch/arm/dts/genio-1200-radxa-nio-12l.dtsi
index 111111111111..222222222222 100644
--- a/arch/arm/dts/genio-1200-radxa-nio-12l.dtsi
+++ b/arch/arm/dts/genio-1200-radxa-nio-12l.dtsi
@@ -195,6 +195,32 @@
 			bias-disable;
 		};
 	};
+
+	mmc1_default_pins: mmc1-default-pins {
+		pins-clk {
+			pinmux = <PINMUX_GPIO111__FUNC_MSDC1_CLK>;
+			bias-pull-down = <MTK_PUPD_SET_R1R0_10>;
+			drive-strength = <8>;
+		};
+
+		pins-cmd-dat {
+			pinmux = <PINMUX_GPIO110__FUNC_MSDC1_CMD>,
+				 <PINMUX_GPIO112__FUNC_MSDC1_DAT0>,
+				 <PINMUX_GPIO113__FUNC_MSDC1_DAT1>,
+				 <PINMUX_GPIO114__FUNC_MSDC1_DAT2>,
+				 <PINMUX_GPIO115__FUNC_MSDC1_DAT3>;
+			bias-pull-up = <MTK_PUPD_SET_R1R0_01>;
+			drive-strength = <8>;
+			input-enable;
+		};
+	};
+
+	mmc1_pins_detect: mmc1-detect-pins {
+		pins-insert {
+			pinmux = <PINMUX_GPIO129__FUNC_GPIO129>;
+			bias-pull-up;
+		};
+	};
 };
 
 &watchdog {
@@ -282,3 +308,20 @@
 		};
 	};
 };
+
+&mmc1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&mmc1_default_pins>, <&mmc1_pins_detect>;
+	bus-width = <4>;
+	max-frequency = <200000000>;
+	cap-sd-highspeed;
+	cd-gpios = <&pio 129 GPIO_ACTIVE_LOW>;
+	no-mmc;
+	no-sdio;
+	sd-uhs-sdr50;
+	sd-uhs-sdr104;
+	/*FIXME: supply is provided by mt6360 ldo5 and 3*/
+	vmmc-supply = <&reg_3p3v>;
+	vqmmc-supply = <&reg_3p3v>;
+	status = "okay";
+};
-- 
Armbian

