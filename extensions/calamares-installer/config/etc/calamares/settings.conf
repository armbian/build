# Calamares Configuration File for Armbian
# This file defines the sequence of modules for the installation process.

# Tells Calamares to look for modules in the 'modules/' subdirectory
# of the configuration directory (/etc/calamares/).
modules-search: [ local ]

# --- Module Instances ---
# This section defines explicit instances for modules that need custom configuration.
# Modules without custom configs can be referenced directly by name in the sequence.
instances:
- id: rsync
  module: rsync
  config: rsync.conf
- id: partition
  module: partition
  config: partition.conf
- id: displaymanager
  module: displaymanager
  config: displaymanager.conf
- id: shellprocess_final
  module: shellprocess
  config: shellprocess_final.conf

# This is the main installation sequence.
# It is divided into 'show' steps (displayed in the UI) and 'exec' steps (run in the background).
# The order is critical.
sequence:
  # --- UI Steps ---
  # These modules will be shown to the user in the graphical wizard.
  - show:
      - welcome      # Welcome screen
      - partition    # Disk partitioning
      - users        # User creation (username, password, root)
      - summary      # Pre-installation summary

  # --- Execution Steps ---
  # These modules perform the actual installation work.
  # They run in the background after the user clicks "Install".
  - exec:
      - partition      # Applies the partitioning choices
      - rsync          # Copies the live filesystem to the target partition
      - machineid      # Creates a unique machine ID
      - fstab          # Generates /etc/fstab
      - locale         # Sets system locale
      - keyboard       # Sets keyboard layout
      - users          # Creates the user accounts
      - displaymanager # Configures the display manager (if applicable)
      - packages       # Installs additional packages (if any are defined)
      - grubcfg        # Prepares GRUB configuration
      - bootloader     # Installs the bootloader to the MBR/EFI
      - shellprocess_final # Runs the final post-installation script

  # --- Final UI Step ---
  # This module is shown after the installation is complete.
  - show:
      - finished       # Installation finished screen

# --- Global Settings ---

# The branding component name. This MUST match the directory name
# in /etc/calamares/branding/ and the 'componentName' in branding.desc.
branding: armbian

# Prompt the user to continue even if there are non-critical errors.
# Set to 'true' for debugging, 'false' for production.
prompt-install: false

# Set to 'true' to prevent Calamares from chrooting into the target system.
# Most modules require this to be 'false'.
dont-chroot: false

# Set to 'true' to enable OEM mode (for pre-installing systems).
oem-setup: false

# UI/UX settings
disable-cancel: false
disable-cancel-during-exec: false
hide-back-and-next-during-exec: false

# Set to 'true' to automatically close Calamares after a successful installation.
quit-at-end: false
