# Rockchip RK3566 quad core 2GB-8GB GBE eMMC NVMe USB3 WiFi
BOARD_NAME="Station M2"
BOARDFAMILY="media"
BOOTCONFIG="firefly-m2-rk3568_defconfig"
KERNEL_TARGET="legacy,current,edge"
FULL_DESKTOP="yes"
BOOT_LOGO="desktop"
BOOT_FDT_FILE="rockchip/rk3566-bigtreetech-cb2.dtb"
SRC_CMDLINE="console=ttyS02,1500000 console=tty0"
ASOUND_STATE="asound.state.station-m2"
BOOT_SCENARIO="spl-blobs"
WIREGUARD="no"
BOOT_SUPPORT_SPI="yes"
BOOT_SPI_RKSPI_LOADER="yes"
IMAGE_PARTITION_TABLE="gpt"
BOOTFS_TYPE="fat"

function post_family_tweaks__station_m2() {
    display_alert "$BOARD" "Installing board tweaks" "info"
	# cp -R $SRC/packages/blobs/station/firmware/* $SDCARD/lib/firmware/rtl_bt/
	cp -R $SRC/packages/blobs/station/firmware/* $SDCARD/lib/firmware/
	if [[ $BRANCH == legacy ]]; then
		install -m 755 $SRC/packages/blobs/station/firmware/rtk_hciattach $SDCARD/usr/bin/rtk_hciattach
		sed -e 's/exit 0//g' -i $SDCARD/etc/rc.local
		echo "su -c 'insmod /usr/lib/modules/4.19.232-station-p2/kernel/drivers/bluetooth/hci_uart.ko'" >> $SDCARD/etc/rc.local
		echo "su -c '/usr/bin/rtk_hciattach -n -s 115200 /dev/ttyS1 rtk_h5 &'" >> $SDCARD/etc/rc.local
		echo "exit 0" >> $SDCARD/etc/rc.local
	fi

	return 0
}
