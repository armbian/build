# SpacemiT M1 octa core RISC-V SoC 8GB/16GB RAM 64GB/128GB eMMC 4x USB3 1x GbE
BOARD_NAME="SpacemiT MusePi Pro"
BOARDFAMILY="spacemit"
BOARD_MAINTAINER="pyavitz"
BOARD_VENDOR="spacemit"
KERNEL_TARGET="legacy,current,edge"
BOOT_FDT_FILE="spacemit/k1-musepi-pro.dtb"
BOOTDELAY=1
SRC_EXTLINUX="yes"
SRC_CMDLINE="earlycon=sbi console=tty1 console=ttyS0,115200 loglevel=1"
PACKAGE_LIST_BOARD="rfkill bluetooth bluez bluez-tools"

function post_config_uboot_target__extra_configs_for_musepi_pro() {
	display_alert "u-boot for ${BOARD}" "u-boot: enabling extra configs" "info"
	run_host_command_logged scripts/config --enable CONFIG_SD_BOOT
	run_host_command_logged scripts/config --enable CONFIG_EXT4_WRITE
	run_host_command_logged scripts/config --enable CONFIG_FS_BTRFS
	run_host_command_logged scripts/config --enable CONFIG_CMD_BTRFS
	run_host_command_logged scripts/config --enable CONFIG_SPI_FLASH_USE_4K_SECTORS
}

function post_family_tweaks_bsp__musepi_pro_extras() {
	if [[ -d "$SRC/packages/blobs/riscv64/spacemit" ]]; then
		run_host_command_logged mkdir -pv "${destination}"/lib/firmware
		display_alert "$BOARD" "Installing boot firmware" "info"
		run_host_command_logged cp -fv $SRC/packages/blobs/riscv64/spacemit/esos.elf "${destination}"/lib/firmware
	fi
	display_alert "$BOARD" "Force load wireless" "info"
	run_host_command_logged mkdir -pv "${destination}"/etc/modules-load.d
	run_host_command_logged echo "8852bs" > "${destination}"/etc/modules-load.d/${BOARD}.conf
}
